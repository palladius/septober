<%
	# Copied by RBates nifty authentication => generated into lib/controller_authentication.rb
	# and extracted here as a first test

begin
  if logged_in? %>
	  Welcome <b><%= link_to(current_user.username.capitalize, edit_current_user_path, :title => "RicPlugin: User number ##{current_user.id}", :class => 'user') %></b>.
	  <%= link_to "Log out", logout_path %>
<% else %>
	  <%= link_to "Sign up", signup_path %> or
	  <%= link_to "log in", login_path %>
<% end 
rescue Exception => e # should happen if u r logged in as unexisting user!
	session[:user_id] = nil
	flash[:notice] = "You have been logged out due to unexpected reason (exception: '#{e}')."
	current_user=nil
end

%>