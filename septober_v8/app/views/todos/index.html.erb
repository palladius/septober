<div class="card">
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
    <h2>Todos</h2>
    <%= form_with url: todos_path, method: :get, local: true, style: "display: flex; gap: 0.5rem;" do |f| %>
      <%= f.text_field :q, value: params[:q], placeholder: "Search todos...", style: "padding: 0.5rem; border: 1px solid #d1d5db; border-radius: 0.375rem;" %>
      <%= f.submit "Search", class: "btn btn-secondary" %>
    <% end %>
    <%= link_to "New Todo", new_todo_path, class: "btn btn-primary" %>
  </div>

  <div class="todos-list">
    <% @todos.each do |todo| %>
      <div class="todo-item <%= 'done' if todo.done? %>">
        <div>
          <strong><%= link_to todo.name, todo %></strong>
          <span style="font-size: 0.8rem; color: <%= todo.project&.color.presence || '#6b7280' %>; font-weight: bold;">
            <%= todo.project.name if todo.project %>
            <% if todo.due %>
              | Due: <%= todo.due %>
            <% end %>
          </span>
        </div>
        <div>
          <% unless todo.done? %>
            <%= link_to "Done", done_todo_path(todo), class: "btn btn-secondary", style: "font-size: 0.8rem;" %>
          <% else %>
            <%= link_to "Undone", undone_todo_path(todo), class: "btn btn-secondary", style: "font-size: 0.8rem; background-color: #9ca3af;" %>
          <% end %>
          <%= link_to "Edit", edit_todo_path(todo), class: "btn", style: "font-size: 0.8rem; background-color: #e5e7eb;" %>
        </div>
      </div>
    <% end %>
  </div>
</div>
